<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.01, user-scalable=no">
    <title></title>
    <link rel="stylesheet" href="/res/css/bootstrap.min.css?ver=<?php echo _CONF('app_v')?>">
</head>
<div style="margin:auto;width:256px;margin-bottom:10px"></div>
<div id="qrcode" style="margin:auto;width:256px;height:256px;margin-bottom:20px"></div>
<div  style="margin:auto;width:256px;height:26px;margin-bottom:10px"> <input style="width:256px" type="text" value="<?=$url?>"></div>
<?php if(!in_array($this->token['RoleID'],[9,10,11])){?>
<div style="margin:auto;width:256px;margin-bottom:10px"><br/> <button id="btnRefresh" type="button" class="btn btn-warning btn-xs" style="text-align: center">重新生成</button></div>
<?php }?>
</body>

</html>

<script src="/res/js/jquery-1.11.3.min.js" type="text/javascript"></script>
<script src="/js/qrcode.min.js" type="text/javascript"></script>
<script type="text/javascript">
    var qrcode = new QRCode("qrcode", {
        text: "<?=$url?>",
        width: 256,
        height: 256,
        colorDark : "#000000",
        colorLight : "#ffffff",
        correctLevel : QRCode.CorrectLevel.H
    });

</script>
<script>
    $("#btnRefresh").click(function () {
        $.get('qrcode.aspx?action=share&code=<?php echo $code;?>&cache=1',function(){
            window.location.reload();
        });
    });
</script>